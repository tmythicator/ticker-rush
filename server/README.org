#+TITLE: Ticker Rush — Exchange Server
#+AUTHOR: Alexandr Timchenko
#+OPTIONS: toc:nil num:nil

* Overview
High-performance market data engine written in *Go*.
Acts as a proxy and caching layer between the expensive external API (Finnhub) and high-load frontend clients.

* Microservices Architecture
The backend is split into two independent processes sharing a Data Layer (Valkey):

** 1. Fetcher Service (=cmd/fetcher=)
- *Role:* Producer.
- Runs in the background.
- Polls Finnhub API every *3 seconds* (Safe Mode).
- Writes latest quotes to Valkey (Redis).

** 2. Exchange API (=cmd/exchange=)
- *Role:* Consumer.
- Built with *Gin Framework*.
- Reads data directly from Valkey RAM.
- Decoupled from external API limits (1000 users = 0 extra load on Finnhub).

* Setup & Run

** 1. Environment Variables
Create a =.env= file in this directory:
#+BEGIN_SRC text
FINNHUB_API_KEY=your_api_key_here
#+END_SRC

** 2. Dependencies
Ensure you have a Redis/Valkey instance running on =localhost:6379=.

#+BEGIN_SRC bash
# Install Go modules
go mod tidy
#+END_SRC

** 3. Run Services
You must run both services for the system to work fully.

#+BEGIN_SRC bash
# Terminal 1: Start the data ingestion
go run ./cmd/fetcher

# Terminal 2: Start the Exchange API
go run ./cmd/exchange
#+END_SRC

* "Safe Mode" (Rate Limiting)
To prevent getting banned by Finnhub on the free tier, the server operates in a strict allowlist mode.

** Configuration (=server/lib/config.go=)
- *Poll Interval:* 3 seconds
- *Tracked Assets:*
  - =AAPL= (NASDAQ)
  - =BINANCE:BTCUSDT= (Crypto)

* Project Structure
- =cmd/exchange/= — Exchange API entry point.
- =cmd/fetcher/= — Background worker entry point.
- =internal/= —  Shared utilities, configuration and application logic.
- =model/= — Data structures (DTOs and Domain models).