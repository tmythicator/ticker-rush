// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: portfolio.sql

package sqlc

import (
	"context"
)

const deletePortfolioItem = `-- name: DeletePortfolioItem :exec
DELETE FROM portfolio_items
WHERE user_id = $1 AND stock_symbol = $2
`

type DeletePortfolioItemParams struct {
	UserID      int64
	StockSymbol string
}

func (q *Queries) DeletePortfolioItem(ctx context.Context, arg DeletePortfolioItemParams) error {
	_, err := q.db.Exec(ctx, deletePortfolioItem, arg.UserID, arg.StockSymbol)
	return err
}

const deleteUserPortfolio = `-- name: DeleteUserPortfolio :exec
DELETE FROM portfolio_items
WHERE user_id = $1
`

func (q *Queries) DeleteUserPortfolio(ctx context.Context, userID int64) error {
	_, err := q.db.Exec(ctx, deleteUserPortfolio, userID)
	return err
}

const getPortfolio = `-- name: GetPortfolio :many
SELECT user_id, stock_symbol, quantity, average_price FROM portfolio_items
WHERE user_id = $1
`

func (q *Queries) GetPortfolio(ctx context.Context, userID int64) ([]PortfolioItem, error) {
	rows, err := q.db.Query(ctx, getPortfolio, userID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []PortfolioItem
	for rows.Next() {
		var i PortfolioItem
		if err := rows.Scan(
			&i.UserID,
			&i.StockSymbol,
			&i.Quantity,
			&i.AveragePrice,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getPortfolioItem = `-- name: GetPortfolioItem :one
SELECT user_id, stock_symbol, quantity, average_price 
FROM portfolio_items
WHERE user_id = $1 AND stock_symbol = $2
`

type GetPortfolioItemParams struct {
	UserID      int64
	StockSymbol string
}

func (q *Queries) GetPortfolioItem(ctx context.Context, arg GetPortfolioItemParams) (PortfolioItem, error) {
	row := q.db.QueryRow(ctx, getPortfolioItem, arg.UserID, arg.StockSymbol)
	var i PortfolioItem
	err := row.Scan(
		&i.UserID,
		&i.StockSymbol,
		&i.Quantity,
		&i.AveragePrice,
	)
	return i, err
}

const getPortfolioItemForUpdate = `-- name: GetPortfolioItemForUpdate :one
SELECT user_id, stock_symbol, quantity, average_price 
FROM portfolio_items
WHERE user_id = $1 AND stock_symbol = $2 FOR UPDATE
`

type GetPortfolioItemForUpdateParams struct {
	UserID      int64
	StockSymbol string
}

func (q *Queries) GetPortfolioItemForUpdate(ctx context.Context, arg GetPortfolioItemForUpdateParams) (PortfolioItem, error) {
	row := q.db.QueryRow(ctx, getPortfolioItemForUpdate, arg.UserID, arg.StockSymbol)
	var i PortfolioItem
	err := row.Scan(
		&i.UserID,
		&i.StockSymbol,
		&i.Quantity,
		&i.AveragePrice,
	)
	return i, err
}

const setPortfolioItem = `-- name: SetPortfolioItem :exec
INSERT INTO portfolio_items (user_id, stock_symbol, quantity, average_price)
VALUES ($1, $2, $3, $4)
ON CONFLICT (user_id, stock_symbol)
DO UPDATE SET
    quantity = EXCLUDED.quantity,
    average_price = EXCLUDED.average_price
`

type SetPortfolioItemParams struct {
	UserID       int64
	StockSymbol  string
	Quantity     float64
	AveragePrice float64
}

func (q *Queries) SetPortfolioItem(ctx context.Context, arg SetPortfolioItemParams) error {
	_, err := q.db.Exec(ctx, setPortfolioItem,
		arg.UserID,
		arg.StockSymbol,
		arg.Quantity,
		arg.AveragePrice,
	)
	return err
}
